<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Student doings</title>
<link rel="stylesheet" type="text/css" href="styles/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="styles/library.css" />
<script type="text/javascript" src="js/jquery-2.1.3.min.js"></script>
<script type="text/javascript">
	$.ajax({
		url : '/Shit/StudentServlet',
		type : "GET",
		dataType : "json",
		success : function(data, textStatus, jqXHR) {
			drawTable(data);
		}
	});

	function drawTable(data) {
		for (var i = 0; i < data.length; i++) {
			drawRow(data[i], i);
		}
	}

	function drawRow(rowData, i) {
		var row = $("<tr onclick='rowSelector(" + i + ");'/>")
		$("#books_table").append(row);
		row.append($("<td>" + rowData.firstName + "</td>"));
		row.append($("<td>" + rowData.lastName + "</td>"));
		row.append($("<td>" + rowData.fkNumber + "</td>"));
		row.append($("<td>" + rowData.faculty.name + "</td>"));
		row.append($("<td><form role=\"form\" action=\"StudentServlet\" method=\"post\"><input type=\"hidden\" name=\"deleted\" value=\""+rowData.studentId+"\"/><button type=\"submit\" class=\"btn btn-default\">Изтрий</button></form></td>"));
	}
</script>
<!--  <script type="text/javascript">
	function rowSelector() {
		if (!document.getElementsByTagName || !document.createTextNode)
			return;
		var rows = document.getElementById('books_table').getElementsByTagName(
				'tbody')[0].getElementsByTagName('tr');
		for (i = 0; i < rows.length; i++) {
			rows[i].onclick = function() {
				var tds = rows[i].getElementByTagName('td');
				document.getElementById('userName').value = tds[0].innerText;
				document.getElementById('pwd').value = tds[1].innerText;
				document.getElementById('conf_pwd').value = tds[2].innerText;
			}
		}
	}
</script>-->
<!--  <script type="text/javascript">
	function addRowHandlers() {
		var table = document.getElementById("tableId");
		var rows = table.getElementsByTagName("tr");
		for (i = 0; i < rows.length; i++) {
			var currentRow = table.rows[i];
			var createClickHandler = function(row) {
				return function() {
					var tds = row.getElementsByTagName("td");
					document.getElementById('userName').value = tds[0].innerText;
					document.getElementById('pwd').value = tds[1].innerText;
					document.getElementById('conf_pwd').value = tds[2].innerText;
				};
			};

			currentRow.onclick = createClickHandler(currentRow);
		}
	}
	window.onload = addRowHandlers();
</script>-->
<script type="text/javascript">
	function rowSelector(index) {
		var table = document.getElementById("books_table");
		var row = table.getElementsByTagName("tr")[index];
		var tds = row.getElementsByTagName("td");
		document.getElementById('userName').value = tds[2].innerHTML;
		document.getElementById('pwd').value = tds[0].innerHTML;
		document.getElementById('conf_pwd').value = tds[1].innerHTML;
		document.getElementById('studentId').value = tds[3].getElementByTag("form").getElementByTag("input").value;
	}
</script>
<script type="text/javascript">
	$.ajax({
		url : '/Shit/FacultyServlet',
		type : "GET",
		dataType : "json",
		success : function(data, textStatus, jqXHR) {
			drawDropDown(data);
		}
	});

	function drawDropDown(data) {
		$.each(data, function(i, option) {
			$('#sel').append(
					$('<option/>').attr("value", option.facultyId).text(
							option.name));
		});
	}
</script>
</head>
<body>
	<h1 align="center">
		<b>REGISTRATION FORM</b>
	</h1>

	<form role="form" action="StudentServlet" method="post">
		<div class="form-group">
			<label for="userName">Факултетен:</label> <input type="text"
				class="form-control" name="fkNumber" id="userName">
		</div>
		<div class="form-group">
			<label for="pwd">Име:</label> <input type="text" class="form-control"
				name="firstName" id="pwd">
		</div>

		<div class="form-group">
			<label for="conf_pwd">Фамилия</label> <input type="text"
				class="form-control" name="lastName" id="conf_pwd">
		</div>
		<div class="form-group">
			<label for="dropdown">Факултет</label><select id="sel"
				class="form_control" name="facultyId" id="dropdown">
			</select>
		</div>
		<input type="hidden" name="studentId" />
		<button type="reset" class="btn btn-default">Reset</button>
		<button type="submit" class="btn btn-default">Submit</button>
	</form>
	<div align="center">
		<h1>All Students</h1>
	</div>
	<div>
		<table id="books_table" class="table">
			<tr>
				<th>Име</th>
				<th>Фамилия</th>
				<th>Факултетен</th>
				<th>Факултет</th>
				<th>Изтрий</th>
			</tr>
		</table>
	</div>
</body>
</html>